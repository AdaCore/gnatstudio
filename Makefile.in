CP              = cp -p
MKDIR           = mkdir -p
STRIP           = strip
INSTALL         = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA    = @INSTALL_DATA@
prefix          = @prefix@
bindir          = $(prefix)/bin
sharedir        = $(prefix)/share

export TP_TASKING = No_Tasking

default build compile link ada c c++:
	$(MAKE) -s -C glide -f Makefile.gps $@

clean:
	$(RM) gnat/*.ad*
	$(RM) obj/*.ali obj/*.o
	$(MAKE) -s -C glide -f Makefile.gps $@

install-common:
	$(MKDIR) $(bindir)
	$(MKDIR) $(sharedir)
	$(MKDIR) $(sharedir)/gps
	$(MKDIR) $(sharedir)/gps/docgen
	(cd share; tar cf - customize/*.xml) | (cd $(sharedir)/gps; tar xf -)
	(cd share; tar cf - python/) | (cd $(sharedir)/gps; tar xf -)
	(cd share; tar cf - icons/)  | (cd $(sharedir)/gps; tar xf -)
	(cd docgen/templates; tar cf - html/) \
		| (cd $(sharedir)/gps/docgen; tar xf -)
	$(MAKE) -C docs install

install: install-common
	$(INSTALL_PROGRAM) glide/obj/gps $(bindir)
	$(MAKE) -C kernel/src_info/sn/snsrc install

install-strip: install-common
	$(INSTALL_PROGRAM) -s glide/obj/gps $(bindir)
	$(MAKE) -C kernel/src_info/sn/snsrc install-strip

gvd:
	$(MAKE) -s -C gvd -f Makefile.gvd EXEC=gvd ADA_SOURCES=gvd_main.adb

.PHONY: gvd install install-common install-strip
