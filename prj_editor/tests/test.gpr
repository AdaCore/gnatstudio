project Test is

   type OS_Type is ("Linux", "Windows");
   OS : OS_Type := external ("OS", "Linux");

   type OS_Type2 is ("Linux", "Windows");
   OS3 : OS_Type2 := "Linux"; --  not a scenario variable
   OS4 := external ("OS", "foo");  --  not a scenario variable
   for Source_Dirs use (".");

   type Target_Type is ("Devel", "Release");
   Target : Target_Type := external ("TARGET", "Devel");

   package Builder is
     OS2 : OS_Type := external ("OS2", "Linux");
     case OS is
         when "Linux" =>
             --  case OS is
             --     when "Linux" =>
             for Default_Switches ("Ada") use ("-mlinux");
             --  end case;
         when others =>
             for Default_Switches ("Ada") use ("-mwindows");
     end case;

     case Target is
         when "Devel" =>
             for Default_Switches ("Ada")
                use Builder'Default_Switches & ("-g");
         when "Release" =>
             for Default_Switches ("Ada") 
                use Builder'Default_Switches & ("-O2");
     end case;
   end Builder;

   case OS is
       when "Linux" => 
          for Source_Dirs use Test'Source_Dirs & ("prj11");
       when "Windows" => 
          for Source_Dirs use Test'Source_Dirs & ("prj1/foo");
          case Target is
             when "Devel" =>
                for Source_Dirs use Test'Source_Dirs & ("prj1/bar");
          end case;

   end case;

   for Source_Dirs use Test'Source_Dirs & ("..");
 
end Test;
