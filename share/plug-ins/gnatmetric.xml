<?xml version="1.0" ?>

<!--  This file adds support for the gnatmetric utility.
      This external tool generates a set of software metrics -->

<gnatmetric>
  <action name="metrics project" >
     <filter id="Project only" language="ada" />
     <description>Run GNAT Metrics on a project</description>
     <shell show-command="false">Editor.save</shell>
     <shell>echo gnat metric -x "%pps"</shell>
     <external>gnat metric -v -x "%pps"</external>
     <on-failure>
         <shell>Locations.parse "%1" category</shell>
     </on-failure>
     <shell show-command="false" output="none">XMLViewer "Metrics (%p)"</shell>
     <shell show-command="false">XMLViewer.parse %1 metrix.xml</shell>
  </action>

  <action name="metrics root project" >
     <description>Run GNAT Metrics on a root project</description>
     <shell show-command="false">Editor.save</shell>
     <shell>echo gnat metric -x "%PPs"</shell>
     <external>gnat metric -v -x "%PPs"</external>
     <on-failure>
         <shell>Locations.parse "%1" category</shell>
     </on-failure>
     <shell show-command="false" output="none">XMLViewer "Metrics (%P)"</shell>
     <shell show-command="false">XMLViewer.parse %1 metrix.xml</shell>
  </action>

  <action name="metrics file" >
     <filter id="File" language="ada" />
     <description>Run GNAT Metrics on a single file</description>
     <shell show-command="false">Editor.save</shell>
     <shell>echo gnat metric -x "%pps" "%F"</shell>
     <external>gnat metric -x "%pps" "%F"</external>
     <on-failure>
         <shell>Locations.parse "%1" category</shell>
     </on-failure>
     <shell show-command="false" output="none">XMLViewer "Metrics (%f)"</shell>
     <shell show-command="false">XMLViewer.parse %1 metrix.xml</shell>
  </action>

  <contextual action="metrics project" >
     <Title>Compute metrics for %p</Title>
  </contextual>
  <contextual action="metrics file" >
     <Title>Compute metrics for %f</Title>
  </contextual>

  <Submenu>
     <Title>Tools/Metrics</Title>
     <menu action="metrics root project">
        <Title>Compute metrics for root project</Title>
     </menu>
     <menu action="metrics file">
        <Title>Compute metrics for current file</Title>
     </menu>
  </Submenu>

</gnatmetric>
