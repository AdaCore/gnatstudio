<?xml version="1.0" ?>
<!--  Adds support for GNAT's gnatpp tool

      The gnatpp tool is a command line pretty printer for Ada code,
      provided with the GNAT compiler.
      This package integrates it into GPS:
        - menu /Edit/Pretty Print
        - switches edition through the project editor
-->

<GPS>
   <action name="Pretty print" output="none" category="Editor" >
      <description>Reformat the current Ada source file, and reload the reformated version. Specific formating options can be set in the project file</description>
      <!-- This action only applies to Ada files -->
      <filter language="ada"
              error="Pretty printing requires an Ada file" />

      <shell>MDI.save_all</shell>
      <shell>Project.scenario_variables_cmd_line -X</shell>
      <shell>Project.root</shell>
      <shell>Project.get_attribute_as_string %1 "gnat" "ide"</shell>
      <external output="" server="tools_server">%1 pretty -rf %pps %3 "%F"</external>
      <on-failure>
        <shell>Locations.parse """%1 """ "Pretty printer"</shell>
      </on-failure>
      <shell>Editor.edit "%F" 0 0 0 true</shell>
   </action>

   <submenu>
     <title>Edit</title>
     <menu action="Pretty print" before="Unit Testing" >
        <title>P_retty Print</title>
     </menu>
   </submenu>

   <tool name="Pretty Printer" package="Pretty_Printer" index="Ada" >
      <language>Ada</language>
      <switches lines="5">
         <title line="1" >Spacing</title>
         <title line="2" >Casing</title>
         <title line="3" >Layout</title>
         <title line="4" >Alignment</title>
         <title line="5" >General</title>

         <spin label="Default indentation" switch="-i" min="1" max="9" default="3" />
         <spin label="Continuation lines" switch="-cl" min="1" max="9" default="2" />
         <spin label="Maximum line length" switch="-M" min="20" max="256"
               default="79" />

         <combo label="Keyword" switch="-k" line="2" noswitch="L" nodigit="L" >
            <combo-entry label="Lower case" value="L" />
            <combo-entry label="Upper case" value="U" />
         </combo>
         <combo label="Attribute" switch="-a" line="2" noswitch="M" nodigit="M"
>
            <combo-entry label="Mixed case" value="M" />
            <combo-entry label="Lower case" value="L" />
            <combo-entry label="Upper case" value="U" />
         </combo>
         <combo label="Pragma" switch="-p" line="2" noswitch="M" nodigit="M" >
            <combo-entry label="Mixed case" value="M" />
            <combo-entry label="Lower case" value="L" />
            <combo-entry label="Upper case" value="U" />
         </combo>

         <combo label="Construct" switch="-l" line="3" noswitch="1" nodigit="1"
>
            <combo-entry label="GNAT style" value="1" />
            <combo-entry label="Compact" value="2" />
            <combo-entry label="Uncompact" value="3" />
         </combo>
         <combo label="Comment" switch="-c" line="3" noswitch="1" nodigit="1" separator="">
            <combo-entry label="GNAT style line indentation" value="1" />
            <combo-entry label="Standard line indentation" value="2" />
         </combo>
         <check label="GNAT style beginning" switch="-c3" line="3"/>
         <check label="Reformat blocks" switch="-c4" line="3"/>

         <check label="Colons in declarations" switch="-A1" line="4" />
         <check label="Assignments in declarations" switch="-A2" line="4" />
         <check label="Assignments in statements" switch="-A3" line="4" />
         <check label="Arrow delimiters in associations" switch="-A4" line="4" />

         <check label="Do not set missing end/exit labels" switch="-e" line="5" />
      </switches>
   </tool>

</GPS>
